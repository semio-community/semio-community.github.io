---
import { Image } from "astro:assets";

export interface Props {
  name: string;
  type: 'university' | 'nonprofit' | 'private' | 'public';
  logo?: ImageMetadata;
  logoUrl?: string;
  website?: string;
  description?: string;
  compact?: boolean;
}

const {
  name,
  type,
  logo,
  logoUrl,
  website,
  description,
  compact = false
} = Astro.props;

const typeLabels = {
  university: 'University',
  nonprofit: 'Not-for-profit',
  private: 'Private Sector',
  public: 'Public Sector'
};

const typeIcons = {
  university: 'üéì',
  nonprofit: 'ü§ù',
  private: 'üè¢',
  public: 'üèõÔ∏è'
};

const typeColors = {
  university: 'from-accent-one/10 to-accent-two/10',
  nonprofit: 'from-accent-two/10 to-special/10',
  private: 'from-special/10 to-accent-one/10',
  public: 'from-accent-base/10 to-accent-two/10'
};
---

{compact ? (
  /* Compact view for listing many partners */
  <a
    href={website}
    target="_blank"
    rel="noopener noreferrer"
    class="block p-4 bg-special-lighter rounded-lg border border-special hover:border-accent-one/40 transition-all group"
  >
    <div class="flex items-center gap-3">
      {(logo || logoUrl) ? (
        <div class="w-12 h-12 flex-shrink-0">
          {logo ? (
            <Image
              src={logo}
              alt={`${name} logo`}
              class="w-full h-full object-contain"
            />
          ) : logoUrl ? (
            <img
              src={logoUrl}
              alt={`${name} logo`}
              class="w-full h-full object-contain"
            />
          ) : null}
        </div>
      ) : (
        <span class="text-2xl">{typeIcons[type]}</span>
      )}
      <div class="flex-1 min-w-0">
        <h3 class="font-semibold text-foreground group-hover:text-accent-one transition-colors truncate">
          {name}
        </h3>
        <p class="text-xs text-color-600 dark:text-color-400">
          {typeLabels[type]}
        </p>
      </div>
    </div>
  </a>
) : (
  /* Full card view with more details */
  <div class={`relative p-6 rounded-lg bg-gradient-to-br ${typeColors[type]} border border-special hover:border-accent-one/40 transition-all`}>
    {/* Type badge */}
    <div class="absolute top-4 right-4">
      <span class="inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-surface/80 text-accent-two">
        {typeIcons[type]} {typeLabels[type]}
      </span>
    </div>

    <div class="pr-32">
      {/* Logo/Icon and Name */}
      <div class="flex items-start gap-4 mb-4">
        {(logo || logoUrl) ? (
          <div class="w-16 h-16 flex-shrink-0 bg-surface rounded-lg p-2">
            {logo ? (
              <Image
                src={logo}
                alt={`${name} logo`}
                class="w-full h-full object-contain"
              />
            ) : logoUrl ? (
              <img
                src={logoUrl}
                alt={`${name} logo`}
                class="w-full h-full object-contain"
              />
            ) : null}
          </div>
        ) : (
          <div class="w-16 h-16 flex-shrink-0 bg-surface/50 rounded-lg flex items-center justify-center">
            <span class="text-3xl">{typeIcons[type]}</span>
          </div>
        )}

        <div class="flex-1">
          <h3 class="text-lg font-semibold mb-1">
            {website ? (
              <a
                href={website}
                target="_blank"
                rel="noopener noreferrer"
                class="gradient-brand-text hover:underline"
              >
                {name}
              </a>
            ) : (
              <span class="gradient-brand-text">{name}</span>
            )}
          </h3>

          {description && (
            <p class="text-sm text-color-600 dark:text-color-400">
              {description}
            </p>
          )}
        </div>
      </div>

      {website && (
        <div class="mt-4 pt-4 border-t border-special">
          <a
            href={website}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 text-sm text-link hover:underline"
          >
            <span>Visit Website</span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
            </svg>
          </a>
        </div>
      )}
    </div>
  </div>
)}

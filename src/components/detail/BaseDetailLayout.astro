---
export interface Props {
  className?: string;
}

const { className = "" } = Astro.props;

// Check which slots have content
const hasBreadcrumbs = Astro.slots.has("breadcrumbs");
const hasHero = Astro.slots.has("hero");
const hasActions = Astro.slots.has("actions");
const hasDescription = Astro.slots.has("description");
const hasContributors = Astro.slots.has("contributors");
const hasMetadata = Astro.slots.has("metadata");
const hasFeatures = Astro.slots.has("features");
const hasSpecs = Astro.slots.has("specifications");
const hasLinks = Astro.slots.has("links");
const hasTags = Astro.slots.has("tags");
const hasStats = Astro.slots.has("stats");
const hasContent = Astro.slots.has("default");
const hasRelated = Astro.slots.has("related");
const hasFooter = Astro.slots.has("footer");

// Legacy slot support for backward compatibility
const hasLegacyContributors = Astro.slots.has("contributors");
---

<article
  class={`detail-layout ${className} ${hasHero ? "pt-16 md:pt-20 lg:pt-4" : "pt-20 lg:pt-4"}`}
>
  <!-- Breadcrumbs Navigation -->
  {
    hasBreadcrumbs && (
      <nav class="mb-6 px-4 md:px-8 lg:px-12" aria-label="Breadcrumb">
        <slot name="breadcrumbs" />
      </nav>
    )
  }

  <!-- Hero Section -->
  {hasHero && <slot name="hero" />}

  <!-- Primary Actions (Website, GitHub, Purchase, etc.) -->
  {
    hasActions && (
      <div class="mb-8 px-4 md:px-8 lg:px-12">
        <slot name="actions" />
      </div>
    )
  }

  <!-- Main Content Container -->
  <div class="detail-content px-4 md:px-8 lg:px-12">
    <!-- Description Section (bio, abstract, description) -->
    {
      hasDescription && (
        <section class="description-section mb-8">
          <slot name="description" />
        </section>
      )
    }

    <!-- Contributors/Organizations Section -->
    {
      (hasContributors || hasLegacyContributors) && (
        <section class="contributors-section mb-8">
          <slot name="contributors" />
        </section>
      )
    }

    <!-- Metadata Cards Section (Event details, Location, etc.) -->
    {
      hasMetadata && (
        <section class="metadata-section mb-8">
          <slot name="metadata" />
        </section>
      )
    }

    <!-- Specifications Section (Hardware specs, Software requirements) -->
    {
      hasSpecs && (
        <section class="specifications-section mb-8">
          <slot name="specifications" />
        </section>
      )
    }

    <!-- Features Section -->
    {
      hasFeatures && (
        <section class="features-section mb-8">
          <slot name="features" />
        </section>
      )
    }

    <!-- External Links Section -->
    {
      hasLinks && (
        <section class="links-section mb-8">
          <slot name="links" />
        </section>
      )
    }

    <!-- Tags and Categories Section -->
    {
      hasTags && (
        <section class="tags-section mb-8">
          <slot name="tags" />
        </section>
      )
    }

    <!-- Statistics Section -->
    {
      hasStats && (
        <section class="stats-section mb-8">
          <slot name="stats" />
        </section>
      )
    }

    <!-- Main MDX/Markdown Content -->
    {
      hasContent && (
        <section class="prose-content mb-12">
          <div class="prose prose-lg dark:prose-invert max-w-none">
            <slot />
          </div>
        </section>
      )
    }

    <!-- Related Items Grid -->
    {
      hasRelated && (
        <section class="related-section mt-12">
          <slot name="related" />
        </section>
      )
    }

    <!-- Footer Section (Citations, References, Additional Info) -->
    {
      hasFooter && (
        <footer class="footer-section mt-12 pt-8 border-t border-accent-one/10">
          <slot name="footer" />
        </footer>
      )
    }
  </div>
</article>

<style>
  .detail-layout {
    width: 100%;
    min-height: 100vh;
  }

  .detail-content {
    max-width: 1400px;
    margin: 0 auto;
  }

  /* Section spacing utilities */
  section {
    animation: fadeIn 0.3s ease-in-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Responsive padding adjustments */
  @media (min-width: 1536px) {
    .detail-content {
      padding-left: 6rem;
      padding-right: 6rem;
    }
  }

  /* Print styles */
  @media print {
    .detail-layout {
      padding-top: 0 !important;
    }

    section {
      break-inside: avoid;
    }

    .hero-section,
    .actions-section,
    .related-section {
      display: none;
    }
  }

  /* Accessibility improvements */
  section:focus-within {
    outline: 2px solid transparent;
    outline-offset: 2px;
  }

  section:focus-visible {
    outline-color: rgb(var(--color-accent-base));
  }

  /* Smooth scrolling for anchor links */
  html {
    scroll-behavior: smooth;
  }

  /* Better typography spacing */
  .prose-content {
    line-height: 1.7;
  }

  .prose-content > :first-child {
    margin-top: 0;
  }

  .prose-content > :last-child {
    margin-bottom: 0;
  }
</style>

---
import { getEntry } from "astro:content";
import { Icon } from "astro-icon/components";

interface Props {
  partnerId: string;
  role?: string;
}

const { partnerId, role } = Astro.props;
const partner = await getEntry("partners", partnerId);

// If partner not found, we'll show unknown organization below
const data = partner?.data;
---

{
  !partner ? (
    <span class="inline-flex items-center gap-2 px-2 py-1.5 bg-gray-100 dark:bg-gray-800 rounded-full">
      <Icon name="solar:buildings-line-duotone" class="w-5 h-5 text-gray-400" />
      <span class="text-sm text-gray-500">Unknown Organization</span>
    </span>
  ) : (
    <a
      href={`/partners/${partnerId}`}
      class="org-chip inline-flex items-center gap-2 px-3 py-1.5 bg-surface-lighter rounded-full border-2 border-accent-one/40 hover:border-accent-two transition-all no-underline group"
    >
      {data?.logo ? (
        <img
          src={data.logo.src}
          alt={data.name}
          class="w-6 h-6 rounded object-contain"
        />
      ) : (
        <Icon
          name="solar:buildings-line-duotone"
          class="w-6 h-6 text-accent-one group-hover:text-accent-two transition-colors"
        />
      )}
      <span class="text-sm font-medium transition-colors">
        {data?.shortName || data?.name || partnerId}
      </span>
      {role && (
        <span class="text-xs text-color-600 dark:text-color-400">â€¢ {role}</span>
      )}
    </a>
  )
}

---
import PageLayout from "@/layouts/Base.astro";
import Section from "@/components/Section.astro";
import ProductCard from "@/components/ProductCard.astro";
import FeatureCard from "@/components/FeatureCard.astro";
import { Icon } from "astro-icon/components";
import { getAllHardware, getHardwareCountByStatus } from "@/data/hardware";

const meta = {
  title: "Hardware",
  description:
    "Community-driven robotics hardware platforms for human-robot interaction research",
};

// Fetch hardware from content collections
const allHardware = await getAllHardware();
const hardwareCounts = await getHardwareCountByStatus();

// Transform hardware data for ProductCard component
const products = allHardware.map((hw) => ({
  name: hw.data.name,
  type: "hardware" as const,
  description: hw.data.shortDescription,
  status: hw.data.status,
  ...(hw.data.images?.hero && { image: hw.data.images.hero }),
  links: {
    primary: {
      label: hw.data.status === "available" ? "Get" : "Learn More",
      url: `/hardware/${hw.id}`,
    },
  },
}));

const services = [
  {
    icon: "solar:settings-minimalistic-line-duotone",
    title: "DFM",
    subtitle: "Design for Manufacturing",
    description:
      "Expert guidance on making your robotic designs production-ready",
  },
  {
    icon: "solar:box-minimalistic-line-duotone",
    title: "CM",
    subtitle: "Contract Manufacturing",
    description: "End-to-end manufacturing services for robotics hardware",
  },
  {
    icon: "solar:database-line-duotone",
    title: "Inventory",
    subtitle: "Inventory Management",
    description: "Storage and inventory solutions for robotics components",
  },
  {
    icon: "solar:cart-large-2-line-duotone",
    title: "Sales",
    subtitle: "Sales & Distribution",
    description: "Connect with the robotics research community",
  },
  {
    icon: "solar:delivery-line-duotone",
    title: "Shipping",
    subtitle: "Global Shipping",
    description: "Worldwide delivery of robotics platforms",
  },
  {
    icon: "solar:headphones-round-line-duotone",
    title: "Support",
    subtitle: "Technical Support",
    description: "Ongoing support for hardware platforms",
  },
];
---

<PageLayout meta={meta}>
  <h1 class="title mb-6">Hardware</h1>

  <!-- Hero Section with CTAs -->
  <Section id="hardware-cta">
    <div class="max-w-4xl mx-auto text-center mb-12">
      <p class="text-lg mb-8 text-color-600 dark:text-color-400">
        Community-driven robotics hardware for reproducible science and
        human-centered robotics.
      </p>
      <div class="flex flex-wrap justify-center gap-4 mb-8">
        <a
          href="#products"
          class="inline-flex items-center justify-center h-12 px-8 text-base font-semibold rounded-lg shadow-lg hover:brightness-110 transition-all gradient-brand-horizontal text-surface"
        >
          Get
        </a>
        <a
          href="#products"
          class="inline-flex items-center justify-center h-12 px-8 text-base font-semibold rounded-lg border-2 border-accent-one hover:bg-accent-one/10 transition-all"
        >
          Rent
        </a>
        <a
          href="#products"
          class="inline-flex items-center justify-center h-12 px-8 text-base font-semibold rounded-lg border-2 border-accent-two hover:bg-accent-two/10 transition-all"
        >
          Buy
        </a>
      </div>

      <!-- Platform Statistics -->
      {
        Object.keys(hardwareCounts).length > 0 && (
          <div class="flex flex-wrap justify-center gap-6 text-sm">
            <div class="flex items-center gap-2">
              <span class="w-3 h-3 bg-green-500 rounded-full" />
              <span>{hardwareCounts.available || 0} Available</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="w-3 h-3 bg-yellow-500 rounded-full" />
              <span>{hardwareCounts.experimental || 0} Experimental</span>
            </div>
            <div class="flex items-center gap-2">
              <span class="w-3 h-3 bg-blue-500 rounded-full" />
              <span>{hardwareCounts["coming-soon"] || 0} Coming Soon</span>
            </div>
          </div>
        )
      }
    </div>
  </Section>

  <!-- Products Section -->
  <Section
    id="products"
    title="Our Platforms"
    subtitle="Open-source robotics hardware for research and education"
  >
    <div class="max-w-6xl mx-auto">
      {
        products.length > 0 ? (
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {products.map((product) => (
              <ProductCard {...product} />
            ))}
          </div>
        ) : (
          <div class="text-center py-12">
            <Icon
              name="solar:box-minimalistic-line-duotone"
              class="w-24 h-24 mx-auto mb-4 text-color-300"
            />
            <p class="text-lg text-color-600 dark:text-color-400">
              Hardware platforms coming soon! Check back later for updates.
            </p>
          </div>
        )
      }
    </div>
  </Section>

  <!-- Services Section -->
  <Section
    id="services"
    title="Our Services"
    subtitle="Comprehensive support for robotics hardware development and deployment"
  >
    <div class="max-w-6xl mx-auto">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {
          services.map((service) => (
            <FeatureCard
              icon={service.icon}
              title={service.title}
              description={`${service.subtitle} â€¢ ${service.description}`}
            />
          ))
        }
      </div>
    </div>
  </Section>

  <!-- Call to Action -->
  <Section id="hardware-contribute">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-3xl font-bold mb-4">Contribute Your Platform</h2>
      <p class="text-lg mb-8 text-color-600 dark:text-color-400">
        Have a robotics platform that could benefit the community? We're always
        looking for new hardware to support.
      </p>
      <div class="flex flex-wrap justify-center gap-4">
        <a
          href="/get-involved"
          class="inline-flex items-center justify-center h-12 px-8 text-base font-semibold rounded-lg shadow-lg hover:brightness-110 transition-all gradient-brand-horizontal text-surface"
        >
          <Icon name="solar:add-circle-line-duotone" class="w-5 h-5 mr-2" />
          Submit Platform
        </a>
        <a
          href="/about"
          class="inline-flex items-center justify-center h-12 px-8 text-base font-semibold rounded-lg border-2 border-special hover:bg-special/10 transition-all"
        >
          <Icon name="solar:info-circle-line-duotone" class="w-5 h-5 mr-2" />
          Learn More
        </a>
      </div>
    </div>
  </Section>
</PageLayout>
